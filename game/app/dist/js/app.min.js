'use strict';

/**
 * @ngdoc overview
 * @name testApp
 * @description
 * # testApp
 *
 * Main module of the application.
 */
angular.module('app', []);

(function() {
    angular.module('game', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/game', {
                    templateUrl: '/views/game.html',
                    controller: 'GameController',
                    controllerAs: 'game',
                    caseInsensitiveMatch: true
                });

            $locationProvider.html5Mode(true);
        }])
        .controller('GameController', ['$http', '$scope', '$routeParams', function($http, $scope, $routeParams) {
            //Custom Profile functionality
            $http.get('/api/userData')
                .success(function(data) {
                    $scope.user = data; //Expose the user data to your angular scope
                });
        }]);
})();

(function() {
    angular.module('leaderboards', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/leaderboards', {
                    templateUrl: '/views/leaderboards.html',
                    controller: 'LeaderboardsController',
                    controllerAs: 'leaderboards',
                    caseInsensitiveMatch: true
                });

            $locationProvider.html5Mode(true);
        }])
        .controller('LeaderboardsController', ['$http', '$scope', '$routeParams', function($http, $scope, $routeParams) {
            $http.get('/api/userData')
                .success(function(data) {
                    $scope.user = data; //Expose the user data to your angular scope
                });
            $http.get('/api/leaderboards')
                .success(function(data) {
                    $scope.leaderboards = data; //Expose the user data to your angular scope
                })
                .error(function(data) {
                    console.log('Error: ' + data);
                });
        }]);
})();

(function() {
    angular.module('login', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/signup', {
                    templateUrl: '/views/signup.html',
                    controller: 'SignupController',
                    controllerAs: 'signup',
                    caseInsensitiveMatch: true
                })
                .when('/login', {
                    templateUrl: '/views/login.html',
                    controller: 'LoginController',
                    controllerAs: 'login',
                    caseInsensitiveMatch: true
                })
                .otherwise({
                    templateUrl: '/views/main.html',
                    controller: 'IndexController',
                    controllerAs: 'index'
                });

            $locationProvider.html5Mode(true); //Use html5Mode so your angular routes don't have #/route
        }])
        .controller('LoginController', ['$http', '$scope', function($http, $scope) {
            // Custom Login functionality
        }])
        .controller('IndexController', ['$http', '$scope', function($http, $scope) {
            // Custom Index functionality
        }])
        .controller('SignupController', ['$http', '$scope', function($http, $scope) {
            // Custom Signup functionality
        }])
        .controller('LoginForm', ['$http', '$scope', function($http, $scope) {
            $scope.login = function() {
                $http
                    .post('/login', {
                        username: this.username,
                        password: this.password
                    })
                    .success(function(data) {
                        console.log(data);
                    });
            }
        }])
        .controller('SignupForm', ['$http', '$scope', function($http, $scope) {
            $scope.signup = function() {
                $http
                    .post('/signup', {
                        username: this.username,
                        password: this.password
                    })
                    .success(function(data) {
                        console.log(data);
                    });
            }
        }])
})();

'use strict';

(function() {
    angular.module('app', ['ngRoute', 'login', 'profile', 'game', 'leaderboards', 'httpFactory', 'common-directives', 'ngLoadScript','angular-growl']);
})();

(function() {
    angular.module('profile', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/profile', {
                    templateUrl: '/views/profile.html',
                    controller: 'ProfileController',
                    controllerAs: 'profile',
                    caseInsensitiveMatch: true
                });

            $locationProvider.html5Mode(true);
        }])
        .controller('ProfileController', ['$http', '$scope', '$routeParams', function($http, $scope, $routeParams) {
            //Custom Profile functionality
            $http.get('/api/userData')
                .success(function(data) {
                    $scope.user = data; //Expose the user data to your angular scope
                });
        }]);
})();

(function(){
    angular.module('common-directives', [])
        .directive('redir', ['$http', function($http) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    element.on('click', function(e) {
                        e.preventDefault();
                        window.location = attrs.href;
                    });
                }
            };
        }])
        .directive('logout', ['$http', function($http) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    element.on('click', function(e) {
                        e.preventDefault();
                        $http.post('/logout');
                    });
                }
            };
        }]);
})();


/*
 *  Angular LoadScript
 *
 *  Let angular load and execute lazy javascript from partials!
 *
 *  This module is the result of  this issue: "1.2.0rc1 regression: script tags not loaded via ngInclude"
 *  Issue url: https://github.com/angular/angular.js/issues/3756
 *
 *  As of Angular 1.2.0 the ngInclude scripts does not permit execution of javascript from included partials.
 *  This little module execute code inside script tags with "javascript-lazy" attribute after partial loading,
 *  thus re-enabling this feature.
 *
 *  ( please have a look at the issue comments, this angular feature was never planned nor included properly,
 *  was only a drawback of using jQuery for partial inclusion )
 *
 *  This angular module have been created by @endorama (https://github.com/endorama) based upon the code
 *  posted by @olostan (https://github.com/olostan)
 *
 *  Simply add this file, load ngLoadScript module as application dependency and use type="text/javascript-lazy"
 *  as type for script you which to load lazily in partials.
 *
 * License: 2013 - released to the Public Domain.
 */

/*global angular */
(function (ng) {
  'use strict';

  var app = ng.module('ngLoadScript', []);

  app.directive('script', function() {
    return {
      restrict: 'E',
      scope: false,
      link: function(scope, elem, attr)
      {
        if (attr.type==='text/javascript-lazy')
        {
          var s = document.createElement("script");
          s.type = "text/javascript";
          var src = elem.attr('src');
          if(src!==undefined)
          {
              s.src = src;
          }
          else
          {
              var code = elem.text();
              s.text = code;
          }
          document.head.appendChild(s);
          elem.remove();
        }
      }
    };
  });

}(angular));

/*
    Factory that listens to all responses from GET/POST and pre-processes it
    * If data.redirect is present, perform a redirect with angular (Hash redirect)
    * If data.error is present, display growl errors
*/
(function() {
    angular.module('httpFactory', [])
        .factory('myHttpResponseInterceptor',['$q','$location', 'growl',function($q,$location, growl){
            return {
                response: function(response) {
                    if (typeof response.data === 'object') {
                        if (response.data.redirect) {
                            $location.path(response.data.redirect);
                            return {} || $q.when(response);
                        } else if (response.data.error) {
                            growl.addErrorMessage(response.data.error);
                        }
                    }
                    return response || $q.when(response);
                }
            };
        }])
        .config(['$httpProvider', function($httpProvider) {
            $httpProvider.interceptors.push('myHttpResponseInterceptor');
        }]);
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2dhbWUuanMiLCJjb250cm9sbGVycy9sZWFkZXJib2FyZHMuanMiLCJjb250cm9sbGVycy9sb2dpbi5qcyIsImNvbnRyb2xsZXJzL21haW4uanMiLCJjb250cm9sbGVycy9wcm9maWxlLmpzIiwiZGlyZWN0aXZlcy9jb21tb24uanMiLCJmYWN0b3JpZXMvYW5ndWxhci1sb2Fkc2NyaXB0LmpzIiwiZmFjdG9yaWVzL2h0dHBJbnRlcmNlcHRvci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIEBuZ2RvYyBvdmVydmlld1xuICogQG5hbWUgdGVzdEFwcFxuICogQGRlc2NyaXB0aW9uXG4gKiAjIHRlc3RBcHBcbiAqXG4gKiBNYWluIG1vZHVsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXSk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2dhbWUnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgICAgIC53aGVuKCcvZ2FtZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvZ2FtZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0dhbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZ2FtZScsXG4gICAgICAgICAgICAgICAgICAgIGNhc2VJbnNlbnNpdGl2ZU1hdGNoOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdHYW1lQ29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsIGZ1bmN0aW9uKCRodHRwLCAkc2NvcGUsICRyb3V0ZVBhcmFtcykge1xuICAgICAgICAgICAgLy9DdXN0b20gUHJvZmlsZSBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdXNlckRhdGEnKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSBkYXRhOyAvL0V4cG9zZSB0aGUgdXNlciBkYXRhIHRvIHlvdXIgYW5ndWxhciBzY29wZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdsZWFkZXJib2FyZHMnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgICAgIC53aGVuKCcvbGVhZGVyYm9hcmRzJywge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sZWFkZXJib2FyZHMuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMZWFkZXJib2FyZHNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbGVhZGVyYm9hcmRzJyxcbiAgICAgICAgICAgICAgICAgICAgY2FzZUluc2Vuc2l0aXZlTWF0Y2g6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgICAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xlYWRlcmJvYXJkc0NvbnRyb2xsZXInLCBbJyRodHRwJywgJyRzY29wZScsICckcm91dGVQYXJhbXMnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlLCAkcm91dGVQYXJhbXMpIHtcbiAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS91c2VyRGF0YScpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlciA9IGRhdGE7IC8vRXhwb3NlIHRoZSB1c2VyIGRhdGEgdG8geW91ciBhbmd1bGFyIHNjb3BlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvbGVhZGVyYm9hcmRzJylcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sZWFkZXJib2FyZHMgPSBkYXRhOyAvL0V4cG9zZSB0aGUgdXNlciBkYXRhIHRvIHlvdXIgYW5ndWxhciBzY29wZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOiAnICsgZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2xvZ2luJywgW10pXG4gICAgICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgICAgICAgICAud2hlbignL3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc2lnbnVwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2lnbnVwQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3NpZ251cCcsXG4gICAgICAgICAgICAgICAgICAgIGNhc2VJbnNlbnNpdGl2ZU1hdGNoOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xvZ2luJyxcbiAgICAgICAgICAgICAgICAgICAgY2FzZUluc2Vuc2l0aXZlTWF0Y2g6IHRydWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9tYWluLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSW5kZXhDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaW5kZXgnXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTsgLy9Vc2UgaHRtbDVNb2RlIHNvIHlvdXIgYW5ndWxhciByb3V0ZXMgZG9uJ3QgaGF2ZSAjL3JvdXRlXG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgWyckaHR0cCcsICckc2NvcGUnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlKSB7XG4gICAgICAgICAgICAvLyBDdXN0b20gTG9naW4gZnVuY3Rpb25hbGl0eVxuICAgICAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0luZGV4Q29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHNjb3BlJywgZnVuY3Rpb24oJGh0dHAsICRzY29wZSkge1xuICAgICAgICAgICAgLy8gQ3VzdG9tIEluZGV4IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTaWdudXBDb250cm9sbGVyJywgWyckaHR0cCcsICckc2NvcGUnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlKSB7XG4gICAgICAgICAgICAvLyBDdXN0b20gU2lnbnVwIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdMb2dpbkZvcm0nLCBbJyRodHRwJywgJyRzY29wZScsIGZ1bmN0aW9uKCRodHRwLCAkc2NvcGUpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRodHRwXG4gICAgICAgICAgICAgICAgICAgIC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTaWdudXBGb3JtJywgWyckaHR0cCcsICckc2NvcGUnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2lnbnVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJGh0dHBcbiAgICAgICAgICAgICAgICAgICAgLnBvc3QoJy9zaWdudXAnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pXG59KSgpO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsICdsb2dpbicsICdwcm9maWxlJywgJ2dhbWUnLCAnbGVhZGVyYm9hcmRzJywgJ2h0dHBGYWN0b3J5JywgJ2NvbW1vbi1kaXJlY3RpdmVzJywgJ25nTG9hZFNjcmlwdCcsJ2FuZ3VsYXItZ3Jvd2wnXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdwcm9maWxlJywgW10pXG4gICAgICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgICAgICAgICAud2hlbignL3Byb2ZpbGUnLCB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2ZpbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2ZpbGUnLFxuICAgICAgICAgICAgICAgICAgICBjYXNlSW5zZW5zaXRpdmVNYXRjaDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBbJyRodHRwJywgJyRzY29wZScsICckcm91dGVQYXJhbXMnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlLCAkcm91dGVQYXJhbXMpIHtcbiAgICAgICAgICAgIC8vQ3VzdG9tIFByb2ZpbGUgZnVuY3Rpb25hbGl0eVxuICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3VzZXJEYXRhJylcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0gZGF0YTsgLy9FeHBvc2UgdGhlIHVzZXIgZGF0YSB0byB5b3VyIGFuZ3VsYXIgc2NvcGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgIGFuZ3VsYXIubW9kdWxlKCdjb21tb24tZGlyZWN0aXZlcycsIFtdKVxuICAgICAgICAuZGlyZWN0aXZlKCdyZWRpcicsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGF0dHJzLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuICAgICAgICAuZGlyZWN0aXZlKCdsb2dvdXQnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKTtcbn0pKCk7XG4iLCJcbi8qXG4gKiAgQW5ndWxhciBMb2FkU2NyaXB0XG4gKlxuICogIExldCBhbmd1bGFyIGxvYWQgYW5kIGV4ZWN1dGUgbGF6eSBqYXZhc2NyaXB0IGZyb20gcGFydGlhbHMhXG4gKlxuICogIFRoaXMgbW9kdWxlIGlzIHRoZSByZXN1bHQgb2YgIHRoaXMgaXNzdWU6IFwiMS4yLjByYzEgcmVncmVzc2lvbjogc2NyaXB0IHRhZ3Mgbm90IGxvYWRlZCB2aWEgbmdJbmNsdWRlXCJcbiAqICBJc3N1ZSB1cmw6IGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvaXNzdWVzLzM3NTZcbiAqXG4gKiAgQXMgb2YgQW5ndWxhciAxLjIuMCB0aGUgbmdJbmNsdWRlIHNjcmlwdHMgZG9lcyBub3QgcGVybWl0IGV4ZWN1dGlvbiBvZiBqYXZhc2NyaXB0IGZyb20gaW5jbHVkZWQgcGFydGlhbHMuXG4gKiAgVGhpcyBsaXR0bGUgbW9kdWxlIGV4ZWN1dGUgY29kZSBpbnNpZGUgc2NyaXB0IHRhZ3Mgd2l0aCBcImphdmFzY3JpcHQtbGF6eVwiIGF0dHJpYnV0ZSBhZnRlciBwYXJ0aWFsIGxvYWRpbmcsXG4gKiAgdGh1cyByZS1lbmFibGluZyB0aGlzIGZlYXR1cmUuXG4gKlxuICogICggcGxlYXNlIGhhdmUgYSBsb29rIGF0IHRoZSBpc3N1ZSBjb21tZW50cywgdGhpcyBhbmd1bGFyIGZlYXR1cmUgd2FzIG5ldmVyIHBsYW5uZWQgbm9yIGluY2x1ZGVkIHByb3Blcmx5LFxuICogIHdhcyBvbmx5IGEgZHJhd2JhY2sgb2YgdXNpbmcgalF1ZXJ5IGZvciBwYXJ0aWFsIGluY2x1c2lvbiApXG4gKlxuICogIFRoaXMgYW5ndWxhciBtb2R1bGUgaGF2ZSBiZWVuIGNyZWF0ZWQgYnkgQGVuZG9yYW1hIChodHRwczovL2dpdGh1Yi5jb20vZW5kb3JhbWEpIGJhc2VkIHVwb24gdGhlIGNvZGVcbiAqICBwb3N0ZWQgYnkgQG9sb3N0YW4gKGh0dHBzOi8vZ2l0aHViLmNvbS9vbG9zdGFuKVxuICpcbiAqICBTaW1wbHkgYWRkIHRoaXMgZmlsZSwgbG9hZCBuZ0xvYWRTY3JpcHQgbW9kdWxlIGFzIGFwcGxpY2F0aW9uIGRlcGVuZGVuY3kgYW5kIHVzZSB0eXBlPVwidGV4dC9qYXZhc2NyaXB0LWxhenlcIlxuICogIGFzIHR5cGUgZm9yIHNjcmlwdCB5b3Ugd2hpY2ggdG8gbG9hZCBsYXppbHkgaW4gcGFydGlhbHMuXG4gKlxuICogTGljZW5zZTogMjAxMyAtIHJlbGVhc2VkIHRvIHRoZSBQdWJsaWMgRG9tYWluLlxuICovXG5cbi8qZ2xvYmFsIGFuZ3VsYXIgKi9cbihmdW5jdGlvbiAobmcpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBhcHAgPSBuZy5tb2R1bGUoJ25nTG9hZFNjcmlwdCcsIFtdKTtcblxuICBhcHAuZGlyZWN0aXZlKCdzY3JpcHQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHNjb3BlOiBmYWxzZSxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKVxuICAgICAge1xuICAgICAgICBpZiAoYXR0ci50eXBlPT09J3RleHQvamF2YXNjcmlwdC1sYXp5JylcbiAgICAgICAge1xuICAgICAgICAgIHZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgICBzLnR5cGUgPSBcInRleHQvamF2YXNjcmlwdFwiO1xuICAgICAgICAgIHZhciBzcmMgPSBlbGVtLmF0dHIoJ3NyYycpO1xuICAgICAgICAgIGlmKHNyYyE9PXVuZGVmaW5lZClcbiAgICAgICAgICB7XG4gICAgICAgICAgICAgIHMuc3JjID0gc3JjO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlXG4gICAgICAgICAge1xuICAgICAgICAgICAgICB2YXIgY29kZSA9IGVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICBzLnRleHQgPSBjb2RlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHMpO1xuICAgICAgICAgIGVsZW0ucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9KTtcblxufShhbmd1bGFyKSk7XG4iLCIvKlxuICAgIEZhY3RvcnkgdGhhdCBsaXN0ZW5zIHRvIGFsbCByZXNwb25zZXMgZnJvbSBHRVQvUE9TVCBhbmQgcHJlLXByb2Nlc3NlcyBpdFxuICAgICogSWYgZGF0YS5yZWRpcmVjdCBpcyBwcmVzZW50LCBwZXJmb3JtIGEgcmVkaXJlY3Qgd2l0aCBhbmd1bGFyIChIYXNoIHJlZGlyZWN0KVxuICAgICogSWYgZGF0YS5lcnJvciBpcyBwcmVzZW50LCBkaXNwbGF5IGdyb3dsIGVycm9yc1xuKi9cbihmdW5jdGlvbigpIHtcbiAgICBhbmd1bGFyLm1vZHVsZSgnaHR0cEZhY3RvcnknLCBbXSlcbiAgICAgICAgLmZhY3RvcnkoJ215SHR0cFJlc3BvbnNlSW50ZXJjZXB0b3InLFsnJHEnLCckbG9jYXRpb24nLCAnZ3Jvd2wnLGZ1bmN0aW9uKCRxLCRsb2NhdGlvbiwgZ3Jvd2wpe1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNwb25zZS5kYXRhID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChyZXNwb25zZS5kYXRhLnJlZGlyZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge30gfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm93bC5hZGRFcnJvck1lc3NhZ2UocmVzcG9uc2UuZGF0YS5lcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuICAgICAgICAuY29uZmlnKFsnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIpIHtcbiAgICAgICAgICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ215SHR0cFJlc3BvbnNlSW50ZXJjZXB0b3InKTtcbiAgICAgICAgfV0pO1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
