'use strict';

/**
 * @ngdoc overview
 * @name testApp
 * @description
 * # testApp
 *
 * Main module of the application.
 */
angular.module('app', []);

(function() {
    angular.module('game', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/game', {
                    templateUrl: '/views/game.html',
                    controller: 'GameController',
                    controllerAs: 'game',
                    caseInsensitiveMatch: true
                });

            $locationProvider.html5Mode(true);
        }])
        .controller('GameController', ['$http', '$scope', '$routeParams', function($http, $scope, $routeParams) {
            //Custom Profile functionality
            $http.get('/api/userData')
                .success(function(data) {
                    $scope.user = data; //Expose the user data to your angular scope
                });
        }]);
})();

(function() {
    angular.module('login', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/signup', {
                    templateUrl: '/views/signup.html',
                    controller: 'SignupController',
                    controllerAs: 'signup',
                    caseInsensitiveMatch: true
                })
                .when('/login', {
                    templateUrl: '/views/login.html',
                    controller: 'LoginController',
                    controllerAs: 'login',
                    caseInsensitiveMatch: true
                })
                .otherwise({
                    templateUrl: '/views/main.html',
                    controller: 'IndexController',
                    controllerAs: 'index'
                });

            $locationProvider.html5Mode(true); //Use html5Mode so your angular routes don't have #/route
        }])
        .controller('LoginController', ['$http', '$scope', function($http, $scope) {
            // Custom Login functionality
        }])
        .controller('IndexController', ['$http', '$scope', function($http, $scope) {
            // Custom Index functionality
        }])
        .controller('SignupController', ['$http', '$scope', function($http, $scope) {
            // Custom Signup functionality
        }])
        .controller('LoginForm', ['$http', '$scope', function($http, $scope) {
            $scope.login = function() {
                $http
                    .post('/login', {
                        username: this.username,
                        password: this.password
                    })
                    .success(function(data) {
                        console.log(data);
                    });
            }
        }])
        .controller('SignupForm', ['$http', '$scope', function($http, $scope) {
            $scope.signup = function() {
                $http
                    .post('/signup', {
                        username: this.username,
                        password: this.password
                    })
                    .success(function(data) {
                        console.log(data);
                    });
            }
        }])
})();

'use strict';

(function() {
    angular.module('app', ['ngRoute', 'login', 'profile', 'httpFactory', 'common-directives', 'ngLoadScript','angular-growl', 'game']);
})();

(function() {
    angular.module('profile', [])
        .config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
            $routeProvider
                .when('/profile', {
                    templateUrl: '/views/profile.html',
                    controller: 'ProfileController',
                    controllerAs: 'profile',
                    caseInsensitiveMatch: true
                });

            $locationProvider.html5Mode(true);
        }])
        .controller('ProfileController', ['$http', '$scope', '$routeParams', function($http, $scope, $routeParams) {
            //Custom Profile functionality
            $http.get('/api/userData')
                .success(function(data) {
                    $scope.user = data; //Expose the user data to your angular scope
                });
        }]);
})();

(function(){
    angular.module('common-directives', [])
        .directive('redir', ['$http', function($http) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    element.on('click', function(e) {
                        e.preventDefault();
                        window.location = attrs.href;
                    });
                }
            }
        }])
        .directive('logout', ['$http', function($http) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    element.on('click', function(e) {
                        e.preventDefault();
                        $http.post('/logout');
                    });
                }
            }
        }]);
})();


/*
 *  Angular LoadScript
 *
 *  Let angular load and execute lazy javascript from partials!
 *
 *  This module is the result of  this issue: "1.2.0rc1 regression: script tags not loaded via ngInclude"
 *  Issue url: https://github.com/angular/angular.js/issues/3756
 *
 *  As of Angular 1.2.0 the ngInclude scripts does not permit execution of javascript from included partials.
 *  This little module execute code inside script tags with "javascript-lazy" attribute after partial loading,
 *  thus re-enabling this feature.
 *
 *  ( please have a look at the issue comments, this angular feature was never planned nor included properly,
 *  was only a drawback of using jQuery for partial inclusion )
 *
 *  This angular module have been created by @endorama (https://github.com/endorama) based upon the code
 *  posted by @olostan (https://github.com/olostan)
 *
 *  Simply add this file, load ngLoadScript module as application dependency and use type="text/javascript-lazy"
 *  as type for script you which to load lazily in partials.
 *
 * License: 2013 - released to the Public Domain.
 */

/*global angular */
(function (ng) {
  'use strict';

  var app = ng.module('ngLoadScript', []);

  app.directive('script', function() {
    return {
      restrict: 'E',
      scope: false,
      link: function(scope, elem, attr)
      {
        if (attr.type==='text/javascript-lazy')
        {
          var s = document.createElement("script");
          s.type = "text/javascript";
          var src = elem.attr('src');
          if(src!==undefined)
          {
              s.src = src;
          }
          else
          {
              var code = elem.text();
              s.text = code;
          }
          document.head.appendChild(s);
          elem.remove();
        }
      }
    };
  });

}(angular));

/*
    Factory that listens to all responses from GET/POST and pre-processes it
    * If data.redirect is present, perform a redirect with angular (Hash redirect)
    * If data.error is present, display growl errors
*/
(function() {
    angular.module('httpFactory', [])
        .factory('myHttpResponseInterceptor',['$q','$location', 'growl',function($q,$location, growl){
            return {
                response: function(response) {
                    if (typeof response.data === 'object') {
                        if (response.data.redirect) {
                            $location.path(response.data.redirect);
                            return {} || $q.when(response);
                        } else if (response.data.error) {
                            growl.addErrorMessage(response.data.error);
                        }
                    }
                    return response || $q.when(response);
                }
            };
        }])
        .config(['$httpProvider', function($httpProvider) {
            $httpProvider.interceptors.push('myHttpResponseInterceptor');
        }]);
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2dhbWUuanMiLCJjb250cm9sbGVycy9sb2dpbi5qcyIsImNvbnRyb2xsZXJzL21haW4uanMiLCJjb250cm9sbGVycy9wcm9maWxlLmpzIiwiZGlyZWN0aXZlcy9jb21tb24uanMiLCJmYWN0b3JpZXMvYW5ndWxhci1sb2Fkc2NyaXB0LmpzIiwiZmFjdG9yaWVzL2h0dHBJbnRlcmNlcHRvci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIEBuZ2RvYyBvdmVydmlld1xuICogQG5hbWUgdGVzdEFwcFxuICogQGRlc2NyaXB0aW9uXG4gKiAjIHRlc3RBcHBcbiAqXG4gKiBNYWluIG1vZHVsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXSk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2dhbWUnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgICAgIC53aGVuKCcvZ2FtZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvZ2FtZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0dhbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZ2FtZScsXG4gICAgICAgICAgICAgICAgICAgIGNhc2VJbnNlbnNpdGl2ZU1hdGNoOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdHYW1lQ29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsIGZ1bmN0aW9uKCRodHRwLCAkc2NvcGUsICRyb3V0ZVBhcmFtcykge1xuICAgICAgICAgICAgLy9DdXN0b20gUHJvZmlsZSBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdXNlckRhdGEnKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSBkYXRhOyAvL0V4cG9zZSB0aGUgdXNlciBkYXRhIHRvIHlvdXIgYW5ndWxhciBzY29wZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdsb2dpbicsIFtdKVxuICAgICAgICAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAgICAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgICAgICAgICAgLndoZW4oJy9zaWdudXAnLCB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NpZ251cC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZ251cENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdzaWdudXAnLFxuICAgICAgICAgICAgICAgICAgICBjYXNlSW5zZW5zaXRpdmVNYXRjaDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndoZW4oJy9sb2dpbicsIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbicsXG4gICAgICAgICAgICAgICAgICAgIGNhc2VJbnNlbnNpdGl2ZU1hdGNoOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbWFpbi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0luZGV4Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2luZGV4J1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7IC8vVXNlIGh0bWw1TW9kZSBzbyB5b3VyIGFuZ3VsYXIgcm91dGVzIGRvbid0IGhhdmUgIy9yb3V0ZVxuICAgICAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHNjb3BlJywgZnVuY3Rpb24oJGh0dHAsICRzY29wZSkge1xuICAgICAgICAgICAgLy8gQ3VzdG9tIExvZ2luIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdJbmRleENvbnRyb2xsZXInLCBbJyRodHRwJywgJyRzY29wZScsIGZ1bmN0aW9uKCRodHRwLCAkc2NvcGUpIHtcbiAgICAgICAgICAgIC8vIEN1c3RvbSBJbmRleCBmdW5jdGlvbmFsaXR5XG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignU2lnbnVwQ29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHNjb3BlJywgZnVuY3Rpb24oJGh0dHAsICRzY29wZSkge1xuICAgICAgICAgICAgLy8gQ3VzdG9tIFNpZ251cCBmdW5jdGlvbmFsaXR5XG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignTG9naW5Gb3JtJywgWyckaHR0cCcsICckc2NvcGUnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkaHR0cFxuICAgICAgICAgICAgICAgICAgICAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5wYXNzd29yZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignU2lnbnVwRm9ybScsIFsnJGh0dHAnLCAnJHNjb3BlJywgZnVuY3Rpb24oJGh0dHAsICRzY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRodHRwXG4gICAgICAgICAgICAgICAgICAgIC5wb3N0KCcvc2lnbnVwJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5wYXNzd29yZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKVxufSkoKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nUm91dGUnLCAnbG9naW4nLCAncHJvZmlsZScsICdodHRwRmFjdG9yeScsICdjb21tb24tZGlyZWN0aXZlcycsICduZ0xvYWRTY3JpcHQnLCdhbmd1bGFyLWdyb3dsJywgJ2dhbWUnXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdwcm9maWxlJywgW10pXG4gICAgICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgICAgICAgICAud2hlbignL3Byb2ZpbGUnLCB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2ZpbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2ZpbGUnLFxuICAgICAgICAgICAgICAgICAgICBjYXNlSW5zZW5zaXRpdmVNYXRjaDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBbJyRodHRwJywgJyRzY29wZScsICckcm91dGVQYXJhbXMnLCBmdW5jdGlvbigkaHR0cCwgJHNjb3BlLCAkcm91dGVQYXJhbXMpIHtcbiAgICAgICAgICAgIC8vQ3VzdG9tIFByb2ZpbGUgZnVuY3Rpb25hbGl0eVxuICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3VzZXJEYXRhJylcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0gZGF0YTsgLy9FeHBvc2UgdGhlIHVzZXIgZGF0YSB0byB5b3VyIGFuZ3VsYXIgc2NvcGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgIGFuZ3VsYXIubW9kdWxlKCdjb21tb24tZGlyZWN0aXZlcycsIFtdKVxuICAgICAgICAuZGlyZWN0aXZlKCdyZWRpcicsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGF0dHJzLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pXG4gICAgICAgIC5kaXJlY3RpdmUoJ2xvZ291dCcsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG59KSgpO1xuIiwiXG4vKlxuICogIEFuZ3VsYXIgTG9hZFNjcmlwdFxuICpcbiAqICBMZXQgYW5ndWxhciBsb2FkIGFuZCBleGVjdXRlIGxhenkgamF2YXNjcmlwdCBmcm9tIHBhcnRpYWxzIVxuICpcbiAqICBUaGlzIG1vZHVsZSBpcyB0aGUgcmVzdWx0IG9mICB0aGlzIGlzc3VlOiBcIjEuMi4wcmMxIHJlZ3Jlc3Npb246IHNjcmlwdCB0YWdzIG5vdCBsb2FkZWQgdmlhIG5nSW5jbHVkZVwiXG4gKiAgSXNzdWUgdXJsOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8zNzU2XG4gKlxuICogIEFzIG9mIEFuZ3VsYXIgMS4yLjAgdGhlIG5nSW5jbHVkZSBzY3JpcHRzIGRvZXMgbm90IHBlcm1pdCBleGVjdXRpb24gb2YgamF2YXNjcmlwdCBmcm9tIGluY2x1ZGVkIHBhcnRpYWxzLlxuICogIFRoaXMgbGl0dGxlIG1vZHVsZSBleGVjdXRlIGNvZGUgaW5zaWRlIHNjcmlwdCB0YWdzIHdpdGggXCJqYXZhc2NyaXB0LWxhenlcIiBhdHRyaWJ1dGUgYWZ0ZXIgcGFydGlhbCBsb2FkaW5nLFxuICogIHRodXMgcmUtZW5hYmxpbmcgdGhpcyBmZWF0dXJlLlxuICpcbiAqICAoIHBsZWFzZSBoYXZlIGEgbG9vayBhdCB0aGUgaXNzdWUgY29tbWVudHMsIHRoaXMgYW5ndWxhciBmZWF0dXJlIHdhcyBuZXZlciBwbGFubmVkIG5vciBpbmNsdWRlZCBwcm9wZXJseSxcbiAqICB3YXMgb25seSBhIGRyYXdiYWNrIG9mIHVzaW5nIGpRdWVyeSBmb3IgcGFydGlhbCBpbmNsdXNpb24gKVxuICpcbiAqICBUaGlzIGFuZ3VsYXIgbW9kdWxlIGhhdmUgYmVlbiBjcmVhdGVkIGJ5IEBlbmRvcmFtYSAoaHR0cHM6Ly9naXRodWIuY29tL2VuZG9yYW1hKSBiYXNlZCB1cG9uIHRoZSBjb2RlXG4gKiAgcG9zdGVkIGJ5IEBvbG9zdGFuIChodHRwczovL2dpdGh1Yi5jb20vb2xvc3RhbilcbiAqXG4gKiAgU2ltcGx5IGFkZCB0aGlzIGZpbGUsIGxvYWQgbmdMb2FkU2NyaXB0IG1vZHVsZSBhcyBhcHBsaWNhdGlvbiBkZXBlbmRlbmN5IGFuZCB1c2UgdHlwZT1cInRleHQvamF2YXNjcmlwdC1sYXp5XCJcbiAqICBhcyB0eXBlIGZvciBzY3JpcHQgeW91IHdoaWNoIHRvIGxvYWQgbGF6aWx5IGluIHBhcnRpYWxzLlxuICpcbiAqIExpY2Vuc2U6IDIwMTMgLSByZWxlYXNlZCB0byB0aGUgUHVibGljIERvbWFpbi5cbiAqL1xuXG4vKmdsb2JhbCBhbmd1bGFyICovXG4oZnVuY3Rpb24gKG5nKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgYXBwID0gbmcubW9kdWxlKCduZ0xvYWRTY3JpcHQnLCBbXSk7XG5cbiAgYXBwLmRpcmVjdGl2ZSgnc2NyaXB0JywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICBzY29wZTogZmFsc2UsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cilcbiAgICAgIHtcbiAgICAgICAgaWYgKGF0dHIudHlwZT09PSd0ZXh0L2phdmFzY3JpcHQtbGF6eScpXG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgcy50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgICAgICAgICB2YXIgc3JjID0gZWxlbS5hdHRyKCdzcmMnKTtcbiAgICAgICAgICBpZihzcmMhPT11bmRlZmluZWQpXG4gICAgICAgICAge1xuICAgICAgICAgICAgICBzLnNyYyA9IHNyYztcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZVxuICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgcy50ZXh0ID0gY29kZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzKTtcbiAgICAgICAgICBlbGVtLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG5cbn0oYW5ndWxhcikpO1xuIiwiLypcbiAgICBGYWN0b3J5IHRoYXQgbGlzdGVucyB0byBhbGwgcmVzcG9uc2VzIGZyb20gR0VUL1BPU1QgYW5kIHByZS1wcm9jZXNzZXMgaXRcbiAgICAqIElmIGRhdGEucmVkaXJlY3QgaXMgcHJlc2VudCwgcGVyZm9ybSBhIHJlZGlyZWN0IHdpdGggYW5ndWxhciAoSGFzaCByZWRpcmVjdClcbiAgICAqIElmIGRhdGEuZXJyb3IgaXMgcHJlc2VudCwgZGlzcGxheSBncm93bCBlcnJvcnNcbiovXG4oZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2h0dHBGYWN0b3J5JywgW10pXG4gICAgICAgIC5mYWN0b3J5KCdteUh0dHBSZXNwb25zZUludGVyY2VwdG9yJyxbJyRxJywnJGxvY2F0aW9uJywgJ2dyb3dsJyxmdW5jdGlvbigkcSwkbG9jYXRpb24sIGdyb3dsKXtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuZGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgocmVzcG9uc2UuZGF0YS5yZWRpcmVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9IHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jvd2wuYWRkRXJyb3JNZXNzYWdlKHJlc3BvbnNlLmRhdGEuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcbiAgICAgICAgLmNvbmZpZyhbJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkaHR0cFByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdteUh0dHBSZXNwb25zZUludGVyY2VwdG9yJyk7XG4gICAgICAgIH1dKTtcbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
